﻿
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="format-detection" content="telephone=no">
    <meta http-equiv="cache-control" content="no-store" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <link rel="shortcut icon" href="@Url.Content("~/images/favicon.ico")" />
    <title>Card Benefits Home</title>
    <script src="@System.Configuration.ConfigurationManager.AppSettings["MASTERCARD_TAG_TOOL_PATH"]"></script>
    @{
        List<string> cssPaths = ViewBag.cssPaths;
    }

    @Styles.Render("~/Content/css/bootstrap-4.5.2-dist/css/bootstrap.min.css")
    @Styles.Render("~/Content/fontawesome-free-6.0.0-web/css/all.min.css")


    @foreach (string cssPath in cssPaths)
    {
        @:@Styles.Render("~" + cssPath)
    }

    @Styles.Render("~/Scripts/datatables/datatables.min.css")
    @Scripts.Render("~/Scripts/popper.min.js")
    @Scripts.Render("~/Scripts/jquery-3.5.1.min.js")
    @Scripts.Render("~/Scripts/bootstrap.min.js")
    @Scripts.Render("~/Scripts/spin.min.js")
    @Scripts.Render("~/Scripts/jquery.validate.min.js")
    @Scripts.Render("~/Scripts/jquery.metadata.js")

    @Scripts.Render("~/Scripts/CommonValidations.js")
    @Scripts.Render("~/Scripts/json2.js")
    @Scripts.Render("~/Scripts/jquery.numeric.js")
    @Scripts.Render("~/Scripts/push-menu.js")
    @Scripts.Render("~/Scripts/CSJSRequestObject.js")
    @Scripts.Render("~/Scripts/jquery.language.switcher.js")
    @Scripts.Render("~/Scripts/detect.min.js")


    @Scripts.Render("~/Scripts/custom.js")
    @Scripts.Render("~/Scripts/Common.js")
    @Scripts.Render("~/Scripts/ILMaster.js")
    @Scripts.Render("~/Scripts/Utils.js")

</head>
<body>

    @Html.Raw(ViewBag.header_html)

    @{
        string action = ViewBag.action;
        if (ViewBag.ForceIndex && action == "CardIndex")
        {
            action = "Index";
        }
    }
    @if (ViewBag.Error != null)
    {
        <div class="inner container" style="margin-top: 30px">
            <div id="validation-summary-details" role="alert" class="error-wrap list-warn">
                @ViewBag.Error
            </div>
        </div>
    }

    @using (Html.BeginForm(action, "", FormMethod.Post, new { id = "mainForm" }))
    {
        @Html.AntiForgeryToken()
        @Html.Hidden("slug", (string)ViewBag.slug)
        <input type="hidden" value="@ViewBag.step" name="step" />
        @Html.Raw(ViewBag.step_html)
    }

    @Html.Raw(ViewBag.footer_html)

    <script>
			var mainValidator = $('#mainForm').bind("invalid-form.validate", function () { }).validate({
				errorPlacement: function (error, element) {
					error.prependTo("#error_message");
				},
				//Below are when the validations can be fired of. This one is only being fired off when the form is submitted
				onblur: false,
				onkeyup: false,
				onsubmit: true,
				onclick: false,
				onChange: function (element) {
					$(element).valid();
				},
				onfocusout: function (element) {
					$(element).valid();
				},
				focusInvalid: true,
				errorClass: "error-msg",
				validClass: "success",
				highlight: function (element, errorClass, validClass) {

					// to highlight the div of textbox
					$(element).closest("div.form-group").addClass("input-validation-error");
				},
				unhighlight: function (element, errorClass, validClass) {
					// to unhighlight the div tag of textbox
					$(element).closest("div.form-group").removeClass("input-validation-error");
				},
				//This is grabbing all the errors and placing the errors in the div tag
				showErrors: function (errrorMap, errrorList) {
					var errorMessage = '';
					var x = 0;
					//This will fire off all the Jquery error events.
					this.defaultShowErrors();
					if (this.numberOfInvalids() != 0) {
						setFocus();
						$("#loading").fadeOutpageBottom
					}
				},
				errorPlacement: function (error, element) {
					if ($(element).attr('type') == 'radio' || $(element).attr('type') == 'checkbox') {
						//will insert the error message after error span tag for radiobutton and checkbox
						error.insertAfter($("#" + element[0].id + "-error"));
					}
					else {
						//will insert the error message after div tag for textbox and dropdown
						error.insertAfter(element.closest("div"));
					}
				},
			});

			$(document).ready(function () {

				@Html.Raw(ViewBag.step_logic)

			});

    </script>
</body>
</html>
<!--
@Html.Raw(ViewBag.language)
@Html.Raw(ViewBag.DebugContext)
-->
