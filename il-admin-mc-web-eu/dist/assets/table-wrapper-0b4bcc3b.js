import{r as f,c as R,d as W,j as r,a as $,s as S,e as H,f as L,g as F,h as q,t as E,i as Q,k as _,R as B,S as V,b as h,l as O,B as Y}from"./index-e4dd56a7.js";import{b as A,M as k,u as G,d as I}from"./download-2920f429.js";const J=f.forwardRef(({bsPrefix:e,className:t,striped:n,bordered:s,borderless:a,hover:l,size:i,variant:d,responsive:u,...g},p)=>{const o=R(e,"table"),b=W(t,o,d&&`${o}-${d}`,i&&`${o}-${i}`,n&&`${o}-${typeof n=="string"?`striped-${n}`:"striped"}`,s&&`${o}-bordered`,a&&`${o}-borderless`,l&&`${o}-hover`),m=r("table",{...g,className:b,ref:p});if(u){let c=`${o}-responsive`;return typeof u=="string"&&(c=`${c}-${u}`),r("div",{className:c,children:m})}return m}),K=J,oe=e=>{const t=$.CancelToken.source(),n=S.getState().pagination,s=A(n,e),a=$.get(s,{cancelToken:t.token}).then(l=>l.data).catch(l=>{throw $.isCancel(l)?new Error("Request cancelled"):l});return a.cancel=()=>{t.cancel("Request cancelled by user")},a},ce=({queryKey:e,title:t,onSubmit:n,schema:s,children:a,modalSize:l,show:i,setShow:d,mode:u,icon:g,submitTextButton:p,submitCloseTextButton:o})=>{const b=H({resolver:L(s)}),[m,c]=f.useState(!1),x=F(),[C,y]=f.useState(),M=async v=>{await w(v,!0)},j=async v=>{await w(v,!1)},w=async(v,z)=>{try{c(!0);const T=s.parse(v),N=await n(T);N.statusCode>=200&&N.statusCode<300?(d(!1),y({}),E(N.message),x.refetchQueries(e),z||d(!0)):y(N.errors)}catch(T){console.error(T)}finally{c(!1)}};return r(q,{...b,children:r(k,{showHandleButton:!1,modalSize:l,cancelTextButton:"Close",saveTextButton:p,saveCloseTextButton:o,isLoading:m,onSaveCloseButton:u==="view"||!o?void 0:b.handleSubmit(M),onSaveButton:u==="view"||!p?void 0:b.handleSubmit(j),show:i,setShow:d,titleBody:t,children:a,errors:C,setErrors:y,iconButton:g})})},de=({bodyText:e,title:t,cancelText:n,confirmText:s,onDelete:a,data:l,queryKey:i,handleOnClick:d})=>{const[u,g]=f.useState(!1),[p,o]=f.useState(!1),b=F();return r(k,{showHandleButton:!0,children:e,isLoading:u,onYesButton:async()=>{try{g(!0);const c=await a(l);c.statusCode===200?(o(!1),E(c.message),b.refetchQueries(i)):Q(c.message)}catch(c){console.error(c)}finally{g(!1)}},textButton:"",titleBody:t,variantButton:"danger btn-sm",iconButton:"bi bi-trash3 small",yesTextButton:s,cancelTextButton:n,show:p,setShow:o,setErrors:()=>{},onClick:d})};const U=({columns:e,headerRowProps:t})=>{var n;return r(_,{children:((n=e==null?void 0:e.filter(s=>s.label))==null?void 0:n.length)>0&&r("thead",{children:r("tr",{...t,children:e==null?void 0:e.map((s,a)=>r(B.Fragment,{children:r("td",{align:s.align?s.align:"left",style:{...s.width&&{width:s.width}},...s.headerCellProps,children:r("p",{className:"fw-bolder",children:s.label})})},s.id+"_"+a))})})})},X=(e,t)=>{const n=Z(e,t);if(typeof n=="object"&&n!==null)throw new Error("La ruta "+t+" debe retornar un valor.");return n},Z=(e,t)=>{if(e&&t){const n=t.split(".");let s=e;for(const a of n){if(s[a]===void 0||s[a]===null)return;s=s[a]}return s}else return null},D=({columnProps:e,rowData:t})=>r("td",{align:e.align,style:{...e.width&&{width:e.width}},...e.rowCellProps,children:e.render?e.render(t):X(t,e.data)},t==null?void 0:t.id),P=({rowProps:e,rowIndex:t,onRowClick:n,rowData:s,columns:a})=>r("tr",{...e,onClick:()=>{n==null||n(s,t)},style:{cursor:n?"pointer":"default"},children:a==null?void 0:a.map((l,i)=>r(B.Fragment,{children:r(D,{columnProps:l,rowData:s})},`${t}-${l.id}_${i}`))},t),ee=({data:e,row:t,columns:n,isLoading:s})=>!e||e.length<=0?r("tbody",{children:r("tr",{children:r("td",{colSpan:n==null?void 0:n.length,children:"No hay registros disponibles"})},0)}):r("tbody",{style:{opacity:s?.5:1},children:e==null?void 0:e.map((a,l)=>r(P,{rowProps:t,rowIndex:l,onRowClick:t==null?void 0:t.onRowClick,rowData:a,columns:n},(a==null?void 0:a.id)+"_"+l))}),te=({totalCount:e,data:t,isLoading:n})=>{var d;const s=S.getState().pagination.pageSize,a=((d=t==null?void 0:t.items)==null?void 0:d.length)??"",l=(s<e?s:e)??"",i=l>a?a:l;return n?r("div",{className:"ps-3 pe-3 m-auto",children:r(V,{animation:"border",className:"ocultoMovil",size:"sm",variant:"primary"})}):h("p",{className:"fs-15 ps-3 pe-3 color-text-table me-4 ocultoMovil",style:{fontSize:"12px"},children:["Showing",a===0?" 0-0 ":` 1-${i} `,"records of",` ${e??0} `]})},se=({refetch:e})=>{const{dispatch:t}=S,[n,s]=f.useState(""),a=G(n,i=>t.pagination.setFilter(i),500),l=f.useRef(!0);return f.useEffect(()=>{l.current?l.current=!1:(t.pagination.setPageNumber(0),e())},[a]),r("div",{className:"d-flex align-items-end",children:h("div",{className:"d-flex",children:[r(O.Control,{className:"toolbar-search-input toolbar-border-bottom",type:"text",placeholder:"Search...",value:n,onChange:i=>s(i.target.value)}),r("i",{className:"bi bi-search text-white d-flex justify-content-end align-items-center toolbar-search-icon toolbar-border-bottom pe-2 fs-15"})]})})},ne=async e=>{const{callbackData:t}=e,n=await t(),s=`data:${n.contentType};base64,${n.content}`;I(s,n.fileName)},re=e=>{const[t,n]=f.useState(!1);return f.useRef(null),r("div",{onClick:a=>{n(!t),a.stopPropagation()},children:r("a",{href:"#",onClick:()=>ne(e),className:"ocultoMovil",children:r("i",{className:"bi-file-earmark-spreadsheet text-white fs-5 ps-4 ocultoMovil"})})})},ae=({excelProps:e,title:t,icon:n,actions:s,refetch:a})=>h("div",{className:"d-flex justify-content-between align-items-center toolbar",children:[h("div",{className:"d-flex align-items-center justify-content-start",children:[h("h5",{className:"text-white me-3",children:[" ",r("i",{className:`${n} mt-2`})," "]}),(s==null?void 0:s.new)&&h(Y,{variant:"primary",onClick:s.new,className:"btn btn-toolbar",children:[r("i",{className:"bi-plus-lg text-white"})," ",h("div",{className:"ms-1",children:["  New ",t," "]})]}),!(s!=null&&s.new)&&h("h5",{className:"text-white ms-3",children:[" ",t," "]})]}),h("div",{className:"d-flex align-items-center justify-content-end",children:[r(se,{refetch:a}),e?r(re,{...e}):null]})]}),he=({data:e,columns:t,headerRowProps:n,row:s,isLoading:a,refetch:l,excelProps:i,title:d,icon:u,actions:g})=>{const{dispatch:p}=S,o=b=>{const{scrollTop:m,clientHeight:c,scrollHeight:x}=b.target;if(Math.ceil(m+c)!==x||!(e!=null&&e.hasNextPage))return;const y=S.getState().pagination.pageSize;p.pagination.setPageSize(y+20),l()};return h(B.Fragment,{children:[r(ae,{excelProps:i,title:d,icon:u,actions:g,refetch:l}),r("div",{className:"table-container",onScroll:o,children:h(K,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[r(U,{columns:t,headerRowProps:n}),r(ee,{row:s,columns:t,data:e==null?void 0:e.items,isLoading:a})]})}),r("div",{className:"d-flex justify-content-end align-items-center pt-3 pb-3",children:r(te,{data:e,totalCount:e==null?void 0:e.totalCount,isLoading:a})})]})};export{de as D,ce as M,he as T,oe as g};
