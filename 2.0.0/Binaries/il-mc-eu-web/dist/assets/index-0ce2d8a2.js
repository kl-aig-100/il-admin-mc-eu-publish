import{D as E,n as I,r as y,j as e,L as F,p,E as C,B as o,at as T,K as G,u as A,C as M}from"./index-473ea636.js";import{u as W,D as _,F as k}from"./FormWrapper-7b37d978.js";import{u as U,C as N}from"./ContainerCard-0b0b01a3.js";import{u as O,G as s,B as H,a as K}from"./ButtonSteps-68f2fe5d.js";import{g as f}from"./europe.identifiers-f1731223.js";import{b as R}from"./steps-schema-ebd653c1.js";import{d as $}from"./Edit-9db30227.js";import{j as z,b as n,f as P,T as c,B as w}from"./Navigation-44e5a3e6.js";import{E as B}from"./EcommerceDetails-aa4cb0cd.js";import{H as D}from"./Hidden-c0379fcc.js";import{G as L}from"./Grid2-61f8cc8c.js";const Q=async r=>(await E.put("ecommerce/step3",r)).data,Y=()=>{const{handleFetchApplication:r}=I(),[t,a]=y.useState(!0),x=W({mutationFn:async()=>{const i=f();await Q({id:i})},onSuccess:async()=>{const i=f();r(i!=null?i:0),a(!1)},onError:()=>a(!1)}),d=async()=>await x.mutateAsync();return y.useEffect(()=>{f()?d():a(!1)},[]),{isLoading:t}},q=()=>{const r=z(),t=O(r.breakpoints.up("md"));return e.jsxs(e.Fragment,{children:[e.jsx(n,{identifier:"ecommerce_step3_title_confirm",settings:{variant:"h4",marginBottom:3,textAlign:t?"left":"center"}}),e.jsx(n,{identifier:"ecommerce_step3_information",settings:{variant:"body1",marginBottom:3}})]})},J=({isLoading:r,application:t})=>{const{handleChangeStep:a}=F(),{step:x}=p(),{language:d}=C(),i=()=>a(x-1),l=new Date(t==null?void 0:t.effectiveDate),u=new Date(t==null?void 0:t.expiryDate),g=l.toLocaleDateString(d,{day:"numeric",month:"long",year:"numeric"}),h=u.toLocaleDateString(d,{day:"numeric",month:"long",year:"numeric"});return e.jsx(o,{component:"div",sx:{flexGrow:1},children:e.jsxs(o,{component:"div",children:[e.jsxs(s,{container:!0,spacing:{xs:0,md:12},sx:{marginBottom:4},children:[e.jsxs(s,{item:!0,md:9,children:[e.jsx(q,{}),e.jsx(D,{mdUp:!0,children:e.jsx(s,{item:!0,md:3,style:{paddingBottom:30},children:e.jsx(B,{})})}),e.jsxs(o,{component:"div",display:"flex",alignItems:"center",justifyContent:"space-between",flexDirection:"row",children:[e.jsx(n,{identifier:"ecommerce_step3_cardholder_details",settings:{variant:"h6",gutterBottom:!0}}),e.jsx(T,{show:!(t!=null&&t.closed)||!1,children:e.jsx(P,{label:e.jsx(n,{identifier:"edit",keyStorage:G.COMMONS,settings:{color:"primary"}}),color:"info",iconStart:e.jsx($,{color:"primary"}),size:"small",variant:"text",disabled:(t==null?void 0:t.closed)||!1,onClick:i},2)})]}),e.jsx(_,{sx:{marginTop:0,marginBottom:2}}),e.jsxs(s,{container:!0,rowSpacing:2,columnSpacing:{xs:2,sm:4,md:4},paddingLeft:2,children:[e.jsx(s,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(o,{display:"flex",flexDirection:"row",alignItems:"baseline",children:[e.jsx(n,{identifier:"ecommerce_step3_firstname",settings:{variant:"body1",fontWeight:600,gutterBottom:!0}}),e.jsx(c,{variant:"body1",fontWeight:400,marginLeft:1,children:(t==null?void 0:t.firstName)||""})]})}),e.jsx(s,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(o,{display:"flex",flexDirection:"row",alignItems:"baseline",children:[e.jsx(n,{identifier:"ecommerce_step3_lastname",settings:{variant:"body1",fontWeight:600,gutterBottom:!0}}),e.jsx(c,{variant:"body1",marginLeft:1,children:(t==null?void 0:t.lastName)||""})]})}),e.jsx(s,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(o,{display:"flex",flexDirection:"row",alignItems:"baseline",children:[e.jsx(n,{identifier:"ecommerce_step3_email",settings:{variant:"body1",fontWeight:600,gutterBottom:!0}}),e.jsxs(c,{variant:"body1",marginLeft:1,children:[(t==null?void 0:t.email)||""," "]})]})}),e.jsx(s,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(o,{display:"flex",flexDirection:"row",alignItems:"baseline",children:[e.jsx(n,{identifier:"ecommerce_step3_bin",settings:{variant:"body1",fontWeight:600,gutterBottom:!0}}),e.jsx(c,{variant:"body1",marginLeft:1,children:(t==null?void 0:t.bin)||""})]})})]}),e.jsx(o,{component:"div",display:"flex",alignItems:"center",justifyContent:"space-between",flexDirection:"row",marginTop:3,children:e.jsx(n,{identifier:"ecommerce_step3_certificate_datails",settings:{variant:"h6",gutterBottom:!0}})}),e.jsx(_,{sx:{marginTop:0,marginBottom:2}}),e.jsxs(s,{container:!0,rowSpacing:2,columnSpacing:{xs:2,sm:4,md:4},paddingLeft:2,children:[e.jsx(s,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(o,{display:"flex",flexDirection:"row",alignItems:"baseline",children:[e.jsx(n,{identifier:"ecommerce_step3_effective",settings:{variant:"body1",fontWeight:600,gutterBottom:!0}}),e.jsx(c,{variant:"body1",marginLeft:1,children:g||""})]})}),e.jsx(s,{item:!0,xs:12,sm:6,md:6,children:e.jsxs(o,{display:"flex",flexDirection:"row",alignItems:"baseline",children:[e.jsx(n,{identifier:"ecommerce_step3_expiry",settings:{variant:"body1",fontWeight:600,gutterBottom:!0}}),e.jsx(c,{variant:"body1",marginLeft:1,children:h||""})]})})]})]}),e.jsx(D,{mdDown:!0,children:e.jsx(s,{item:!0,md:3,style:{paddingLeft:30},children:e.jsx(B,{})})})]}),e.jsx(H,{isLoading:r,isFinished:t==null?void 0:t.closed})]})})},V=async r=>(await E.put("ecommerce/step4",r)).data,de=()=>{var v;const{isLoading:r}=Y(),{handleChangeStep:t}=F(),{application:a,handleFetchApplication:x}=I(),[d,i]=y.useState(!1),{country:l}=A(),{language:u}=C(),{handleMessageError:g,handleStepError:h}=U(m=>m),{step:S}=p(m=>m),b=W({mutationFn:async()=>{const m=f();return await V({id:m!=null?m:0,country:l!=null?l:"",language:u!=null?u:""})},onSuccess:async m=>{if(!m.content)return;const j=f();await x(j!=null?j:0),t(S+1),i(!0),h(void 0),g(void 0)},onError:()=>{h(S),g("ecommerce_error_message_step_3")}});return r?e.jsx(M,{}):e.jsxs(w,{component:"div",children:[e.jsx(K,{application:"ecommerce",completed:(v=a.closed)!=null?v:!1}),e.jsx(N,{children:e.jsx(w,{component:"div",sx:{flexGrow:1},marginBottom:2,children:e.jsx(L,{container:!0,display:"flex",alignItems:"start",children:e.jsx(L,{children:e.jsx(k,{schema:R,onSubmit:b.mutateAsync,children:e.jsx(J,{isLoading:b.isLoading,application:a,isFinished:d})})})})})})]})};export{de as default};
