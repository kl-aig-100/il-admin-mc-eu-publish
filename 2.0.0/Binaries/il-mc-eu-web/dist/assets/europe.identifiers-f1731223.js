import{z as O,A as C,D as h,r as c,E as T,F as B,G as L,H as S,q as V,I as F,J as G,K as f,L as R,p as j,M as J,Q as W,j as l,R as D,S as x,T as k}from"./index-473ea636.js";import{D as $,c as z,d as K,e as q,g as A,b as v,T as H,f as b,h as Q}from"./Navigation-44e5a3e6.js";const P="application",M=()=>{const e=O(P);if(e)return JSON.parse(e)},de=e=>C(P,e),Y=()=>{const e=M();if(e)return e.id},X=async(e,t,s)=>(await h.post("/authenticate/url/validate",{country:e,language:t,application:s})).data,fe=()=>{var n;const[e,t]=c.useState(!1),{handleLanguage:s}=T(),{handleCountry:o}=B();var i=(n=M())==null?void 0:n.name;const r=async()=>{try{t(!0);const a=L(S.Application);a!==i&&V(["tokenJwt","europelabels"]);const d=L(S.Country),g=L(S.Language),p=await X(d,g,a),{content:_}=p;F(S.Language,_),s(_),o(d||"GLOBAL")}catch(a){console.error(a)}finally{t(!1)}};return c.useEffect(()=>{r()},[]),{isLoadingValidate:e}},Z=({initialSeconds:e,onPrompt:t,onIdle:s,promptBeforeIdle:o})=>{const[i,r]=c.useState(e),[n,a]=c.useState(!1),[d,g]=c.useState(!1);return c.useEffect(()=>{e&&o&&o>e&&console.error("❌: The promptBeforeIdle value must be less than the initialSeconds value");let m;return i>0&&!n&&(m=setInterval(()=>{r(y=>y-1)},1e3)),i===0&&(g(!0),s&&s()),t&&o&&i===o&&t(),()=>clearInterval(m)},[i,n]),{seconds:i,pause:()=>a(!0),restart:()=>{r(e),a(!1)},resume:()=>a(!1),isIdle:d}},ee=(e=1e4)=>{const[t,s]=c.useState(!1);return c.useEffect(()=>{let o;const i=()=>{s(!0),clearTimeout(o),o=setTimeout(()=>{s(!1)},e)},r=()=>{i()};return window.addEventListener("mousemove",r),window.addEventListener("keydown",r),window.addEventListener("scroll",r),i(),()=>{clearTimeout(o),window.removeEventListener("mousemove",r),window.removeEventListener("keydown",r),window.removeEventListener("scroll",r)}},[e]),t},te=async e=>{const t=await h.post("/admin/translate",e),{data:{content:s}}=t;return s},ge=(e,t=f.LABELS)=>{const{language:s}=T(),{updateLabelsKeys:o,handleIsLoadingLabels:i}=G(n=>n),r=async()=>{try{i(!0);const n=await te({language:s,identifiers:e});C(t,{language:s,labels:n}),o({key:t,labels:n})}catch(n){throw new Error(n==null?void 0:n.message)}finally{i(!1)}};c.useEffect(()=>{const n=O(t),a=JSON.parse(n!=null?n:"{}");s&&(a==null?void 0:a.language)!==s&&r()},[s])},se=async e=>{const t=Y();return t?(await h.get(`/${e}?Id=${t}`)).data.content.step:1},pe=(e,t)=>{const{handleChangeStep:s}=R(),[o,i]=c.useState(!1),{handleStep:r}=j(a=>a),n=c.useCallback(async()=>{try{i(!0);const a=await se(t),d=L(S.Step),g=parseInt(d),p=g<=a?g:a;s(p),r(p)}catch(a){throw new Error(a.message)}finally{i(!1)}},[e]);return c.useEffect(()=>{n()},[]),{isLoading:o}},_e=({stepsLength:e})=>{const{handleSetStepsWorkflow:t}=j(s=>s);c.useEffect(()=>{t(e)},[])},oe=async()=>(await h.get("session")).data.content,N=J(e=>({openDialog:!1,remainingTime:0,handleRemainingTime:t=>e({remainingTime:t}),handleOpenDialog:t=>e({openDialog:t})})),ne=W($)({"& .MuiBackdrop-root":{pointerEvents:"none"}}),ae=({title:e,actions:t,content:s,dialogProps:o})=>l.jsxs(ne,{...o,children:[l.jsx(z,{color:"primary",children:e}),l.jsx(K,{children:s}),l.jsx(q,{sx:{padding:2},children:t})]}),re=({onClose:e,onStay:t})=>{const{openDialog:s,remainingTime:o}=N(a=>a),i=A("workflow_dialog_sign_out_message_1",f.COMMONS),r=A("workflow_dialog_sign_out_message_2",f.COMMONS),n=`${i} ${o} ${r}`;return l.jsx(ae,{dialogProps:{open:s,onClose:e},title:l.jsx(v,{identifier:"workflow_dialog_sign_out_title",keyStorage:f.COMMONS}),content:l.jsxs(H,{variant:"body1",children:[" ",n," "]}),actions:l.jsxs(D.Fragment,{children:[l.jsx(b,{label:l.jsx(v,{identifier:"workflow_stay_sign_in",keyStorage:f.COMMONS,settings:{color:"white"}}),color:"primary",size:"medium",onClick:t},2),l.jsx(b,{label:l.jsx(v,{identifier:"workflow_sign_out",keyStorage:f.COMMONS}),size:"medium",onClick:e,color:"info"},1)]})})},we=({children:e,idlerTimer:t})=>{var m,y;const{handleOpenDialog:s,handleRemainingTime:o}=N(u=>u),i=ee(),r=()=>s(!0),n=()=>a(),a=()=>{var E;s(!1);const u=Q(f.LABELS),I=(E=u==null?void 0:u.labels)==null?void 0:E.find(U=>U.identifier.includes("_final_redirect_url"));x(f.APPLICATION_ID),x(f.TOKEN_JWT),window.location.href=I==null?void 0:I.value},d=async()=>{try{g(),await oe()&&p(),s(!1)}catch(u){throw new Error(u)}finally{_()}},{pause:g,restart:p,resume:_,seconds:w}=Z({initialSeconds:(m=t==null?void 0:t.timeOut)!=null?m:300,promptBeforeIdle:(y=t==null?void 0:t.promptBeforeIdle)!=null?y:15,onPrompt:r,onIdle:n});return c.useEffect(()=>{o(w);let u=!1;u=!1,(w%30===0&&i&&!u||w%30===0&&u)&&d()},[w]),l.jsxs(D.Fragment,{children:[e,l.jsx(re,{onClose:a,onStay:d})]})},ie=k.object({timeOut:k.number(),promptBeforeIdle:k.number()}),ce=async()=>{const e=await h.get("/admin/GetIdlerTimer"),{data:{content:t}}=e;return ie.parse(t)},me=()=>{const[e,t]=c.useState(),[s,o]=c.useState(!1),i=async()=>{try{o(!0);const r=await ce();t(r)}catch(r){throw new Error(r)}finally{o(!1)}};return c.useEffect(()=>{i()},[]),{idlerTimer:e,isLoadingIdlerTimer:s}},Se=["complete_registration","workflow_exit","workflow_next_step","workflow_previous_step","workflow_dialog_stay","workflow_dialog_exit","workflow_dialog_exit_message","workflow_sign_out","workflow_dialog_sign_out_title","document_download_success","document_download_error","exit","edit","error_noEmpty","error_noNumber","error_email","footer_disclaimer_GLOBAL","footer_disclaimer2_GLOBAL","footer_disclaimer_AUT","footer_disclaimer2_AUT","footer_disclaimer_SVN","footer_disclaimer2_SVN","footer_version","workflow_dialog_sign_out_message_1","workflow_dialog_sign_out_message_2","workflow_stay_sign_in","workflow_dialog_sign_out_title","error_checkbox"];export{we as I,fe as a,pe as b,ge as c,me as d,Se as e,M as f,Y as g,de as s,_e as u};
